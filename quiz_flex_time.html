<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة تحدي اتقان القراءة</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: right;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: #1f3f6c;
            text-align: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* --- شاشة الإعدادات --- */
        #setup-screen {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
        }

        .input-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .input-group label {
            font-weight: bold;
            color: #555;
            font-size: 1.1em;
        }

        .input-group input, .input-group select, .input-group textarea {
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            width: 100%;
            box-sizing: border-box;
            background-color: #f9f9f9;
        }
        
        .input-group textarea {
            resize: vertical;
        }


        #start-button {
            padding: 15px;
            background-color: #1f3f6c;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }

        #start-button:hover:not(:disabled) {
            background-color: #1a3456;
        }
        
        #start-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        #view-history-button {
            padding: 15px; 
            background-color: #5bc0de;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        #view-history-button:hover {
            background-color: #31b0d5;
        }


        #error-message {
            color: #d9534f;
            background-color: #f2dede;
            border: 1px solid #ebccd1;
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
            display: none;
            text-align: center;
        }

        /* --- شاشة العرض والتقييم --- */
        #quiz-display {
            text-align: center;
            position: relative;
        }

        #quiz-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #1f3f6c;
            line-height: 1.6;
        }
        
        .timer-info {
            font-size: 1em;
            color: #777;
            margin-bottom: 30px;
        }
        
        .timer-info span {
            font-weight: bold;
            color: #1f3f6c;
        }
        
        /* تنسيق رقم واسم الحرف - تم نقله ليصبح مركزاً وواضحاً */
        #item-number-top {
            font-size: 1.2em;
            font-weight: bold;
            color: #8e24aa;
            text-align: center;
        }

        #item-display {
            min-height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 5px solid #1f3f6c;
            border-radius: 10px;
            margin-bottom: 20px;
            background-color: #fcfcfc;
            overflow: hidden;
            position: relative;
        }
        
        /* شريط الوقت */
        #timer-bar {
            height: 8px;
            background-color: #1f3f6c;
            width: 100%;
            position: absolute;
            bottom: 0; 
            right: 0;
            z-index: 10;
        }

        /* تنسيق عرض المهارات الفردية والجمل والكلمات */
        #current-item.default-display {
            display: flex;
            width: 100%;
            height: 100%;
        }

        .item-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
            font-weight: bold;
        }

        .item-content {
            flex-grow: 1;
            line-height: 2; 
            white-space: pre-wrap; 
            text-align: justify; 
            padding: 30px;
        }

        .item-number {
            width: 150px; 
            min-width: 150px;
            background-color: #f0f0f0;
            font-size: 20px;
        }

        /* تنسيق عرض المهارات المجمعة (القسم الخاص) */
        #current-item.combined-skills {
            display: grid;
            grid-template-columns: 180px repeat(3, 1fr);
            grid-template-rows: repeat(8, 1fr);
            gap: 1px;
            width: 100%;
            height: 100%;
            background-color: #a0c0e0; 
            font-size: 24px;
        }
        
        .grid-cell {
            background-color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            padding: 5px;
            border: 1px solid #a0c0e0;
        }

        .skill-label {
            background-color: #e0eaf4;
            color: #1f3f6c;
            font-weight: normal;
            font-size: 0.8em;
            white-space: nowrap;
            padding: 0 10px;
            justify-content: flex-start;
        }

        /* الأزرار العودة */
        #back-button {
            padding: 10px 20px;
            background-color: #f0ad4e;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 30px;
        }

        #back-button:hover {
            background-color: #ec971f;
        }

        /* زر الانتقال اليدوي */
        #next-manual-button {
            padding: 10px 20px;
            background-color: #1abc9c;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 15px; 
            margin-bottom: 5px;
            width: 100%;
            max-width: 400px;
        }
        
        #next-manual-button:hover {
            background-color: #15a589;
        }
        
        #next-manual-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        /* --- شاشة التقييم --- */
        #assessment-screen {
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background-color: #e9f5ff; /* لون فاتح لشاشة المدرب */
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        #save-assessment-button {
            padding: 15px; 
            background-color: #d9534f; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-size: 1.2em; 
            cursor: pointer; 
            transition: background-color 0.3s; 
            margin-top: 30px; 
            width: 100%;
        }

        /* استجابة العرض */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .input-row {
                flex-direction: column;
                gap: 15px;
            }

            .input-group {
                width: 100%;
            }

            #current-item.combined-skills {
                grid-template-columns: 120px repeat(3, 1fr);
                font-size: 18px;
            }
            
            .item-number {
                width: 100px;
                min-width: 100px;
            }
            
            #assessment-screen {
                margin: 15px auto;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>منصة تحدي اتقان القراءة</h1>
        
        <div id="setup-screen">
            <h2>مبادرة لرفع مستوى الأبناء في القراءة</h2>
            <div id="error-message"></div>

            <div class="input-row">
                <div class="input-group" style="flex: 2;">
                    <label for="trainee-name">اسم المتدرب / اسم المجموعة:</label>
                    <input type="text" id="trainee-name" placeholder="أدخل الاسم">
                </div>
                
                <div class="input-group" style="flex: 1;">
                    <label for="mode-select">طريقة الانتقال:</label>
                    <select id="mode-select">
                        <option value="auto" selected>تلقائي (حسب المؤقت)</option>
                        <option value="manual">يدوي (بالنقر على زر)</option>
                    </select>
                </div>
                </div>

            <div class="input-row">
                 <div class="input-group" id="duration-group" style="flex: 1;">
                    <label for="duration-select">مدة عرض العنصر (بالثواني):</label>
                    <select id="duration-select">
                        <option value="3000">3 ثوانٍ</option>
                        <option value="5000">5 ثوانٍ</option>
                        <option value="7000">7 ثوانٍ</option>
                        <option value="10000" selected>10 ثوانٍ</option> 
                        <option value="15000">15 ثانية</option>
                        <option value="20000">20 ثانية</option>
                        <option value="30000">30 ثانية</option>
                        <option value="60000">1 دقيقة</option>
                    </select>
                    <small id="duration-tip" style="color: #666;">يحدد سرعة الانتقال التلقائي.</small>
                </div>

                <div class="input-group" style="flex: 2;">
                    <label for="level-select">اختر مستوى التحدي:</label>
                    <select id="level-select">
                        <option value="reading" selected>الحروف المدمجة (28 حرف)</option> 
                        <option value="random_skill">تقييم مهاراة الحروف (672 مهارة)</option>
                        <option value="words">الكلمات (219 كلمة)</option>
                        <option value="sentences">الجمل (150 جملة)</option>
                        <option value="passages">القطع الهادفة (20 قطعة)</option> 
                        <option value="mixed_challenge">التقييم (40% مهارات / 30% كلمات / 30% جمل)</option>
                    </select>
                </div>
            </div>

            <div class="input-row">
                <div class="input-group" id="start-index-group" style="flex: 1;">
                    <label for="start-index">رقم البدء:</label>
                    <input type="number" id="start-index" value="1" min="1" max="28">
                    <small id="max-index-tip" style="color: #666;"></small>
                </div>
                
                <div class="input-group" id="limit-count-group" style="flex: 1;">
                    <label for="limit-count">عدد العناصر المطلوب قراءتها:</label>
                    <input type="number" id="limit-count" value="10" min="1">
                    <small id="limit-tip" style="color: #666;">(أدخل 0 أو اتركها فارغة لعرض **كل** العناصر المتاحة).</small>
                </div>
            </div>
            
            <button id="start-button" onclick="validateAndStartQuiz()">اضغط لبدء التدريب</button>
            <button id="view-history-button" onclick="displayAssessmentHistory()">مراجعة سجل التقييمات المحفوظ</button>
        </div>

        <div id="quiz-display" style="display: none;">
            <h2 id="quiz-title"></h2>
            <p class="timer-info" id="advance-mode-info">ستتغير النصوص تلقائيًا كل <span id="time-display">10</span> ثوانٍ.</p>
            
            <div id="item-number-top" style="text-align: center; margin-bottom: 15px;"></div> 
            
            <div id="item-display" style="min-height: 350px; position: relative;">
                <div id="timer-bar"></div>
                
                <div id="current-item" class="default-display" style="width: 100%; height: 100%;">
                    <div style="font-size: 30px; color: #555;">... جارٍ التحميل ...</div>
                </div>
            </div>
            
            <button id="next-manual-button" onclick="handleManualNext()" style="display: none;">
                التالي (اضغط للانتقال)
            </button>
            
            <button id="back-button" onclick="location.reload()">العودة لصفحة الإعدادات</button>
        </div>
        
        <div id="assessment-screen" style="display: none;">
            <h2 id="assessment-title">📝 تقييم نتائج المتدرب</h2>
            <div id="result-summary" style="font-size: 1.2em; margin-bottom: 20px; text-align: center; color: #1f3f6c;"></div>

            <div class="input-row" style="flex-direction: column; gap: 15px;">
                <div class="input-group">
                    <label for="error-count">عدد الأخطاء التي تم رصدها (يدوي):</label>
                    <input type="number" id="error-count" min="0" value="0" placeholder="أدخل عدد الأخطاء">
                </div>
                <div class="input-group">
                    <label for="assessment-notes">ملاحظات المدرب / نتيجة التقييم اليدوي:</label>
                    <textarea id="assessment-notes" rows="4" placeholder="اكتب ملاحظاتك عن أداء المتدرب هنا..."></textarea>
                </div>
            </div>
            
            <button id="save-assessment-button" onclick="saveAssessment()" style="padding: 15px; background-color: #d9534f; color: white; border: none; border-radius: 8px; font-size: 1.2em; cursor: pointer; transition: background-color 0.3s; margin-top: 30px; width: 100%;">
                حفظ التقييم والعودة
            </button>
            
        </div>
        
    </div>

<script>
    // **********************************************
    // ********** 1. قوائم البيانات (بدون تغيير) **********
    // **********************************************

    const SUKUN_PREFIXES = ['يَـ', 'مَـ', 'فِـ']; 
    const SHADDAH_PREFIXES = [ 'لَـ', 'تُـ', 'بِـ'];
    
    const BASE_SKILLS_FOR_RANDOM = {
        'أ': ["أَ", "أُ", "إِ", "آ", "أُو", "إِي", "اً", "أٌ", "إٍ", "اَلْـأَ", "اَلْـأُ", "اَلْـإِ", "أ", "ء"], // (12 + 2)
        'ب': ["بَ", "بُ", "بِ", "بَا", "بُو", "بِي", "بًا", "بٌ", "بٍ", "اَلْـبَ", "اَلْـبُ", "اَلْـبِ", "ب"], 
        'ت': ["تَ", "تُ", "تِ", "تَا", "تُو", "تِي", "تًا", "تٌ", "تٍ", "اَلتَّـ", "اَلتُّـ", "اَلتِّـ", "ت"],
        'ث': ["ثَ", "ثُ", "ثِ", "ثَا", "ثُو", "ثِي", "ثًا", "ثٌ", "ثٍ", "اَلثَّـ", "اَلثُّـ", "اَلثِّـ", "ث"],
        'ج': ["جَ", "جُ", "جِ", "جَا", "جُو", "جِي", "جًا", "جٌ", "جٍ", "اَلْـجَ", "اَلْـجُ", "اَلْـجِ", "ج"], 
        'ح': ["حَ", "حُ", "حِ", "حَا", "حُو", "حِي", "حًا", "حٌ", "حٍ", "اَلْـحَ", "اَلْـحُ", "اَلْـحِ", "ح"], 
        'خ': ["خَ", "خُ", "خِ", "خَا", "خُو", "خِي", "خًا", "خٌ", "خٍ", "اَلْـخَ", "اَلْْـخُ", "اَلْْـخِ", "خ"], 
        'د': ["دَ", "دُ", "دِ", "دَا", "دُو", "دِي", "دًا", "دٌ", "دٍ", "اَلدَّـ", "اَلدُّـ", "اَلدِّـ", "د"],
        'ذ': ["ذَ", "ذُ", "ذِ", "ذَا", "ذُو", "ذِي", "ذًا", "ذٌ", "ذٍ", "اَلذَّـ", "اَلذُّـ", "اَلذِّـ", "ذ"],
        'ر': ["رَ", "رُ", "رِ", "رَا", "رُو", "رِي", "رًا", "رٌ", "رٍ", "اَلرَّـ", "اَلرُّـ", "اَلرِّـ", "ر"],
        'ز': ["زَ", "زُ", "زِ", "زَا", "زُو", "زِي", "زًا", "زٌ", "زٍ", "اَلزَّـ", "اَلزُّـ", "اَلزِّـ", "ز"],
        'س': ["سَ", "سُ", "سِ", "سَا", "سُو", "سِي", "سًا", "سٌ", "سٍ", "اَلسَّـ", "اَلسُّـ", "اَلسِّـ", "س"],
        'ش': ["شَ", "شُ", "شِ", "شَا", "شُو", "شِي", "شًا", "شٌ", "شٍ", "اَلسَّـ", "اَلسُّـ", "اَلسِّـ", "ش"],
        'ص': ["صَ", "صُ", "صِ", "صَا", "صُو", "صِي", "صًا", "صٌ", "صٍ", "اَلصَّـ", "اَلصُّـ", "اَلصِّـ", "ص"],
        'ض': ["ضَ", "ضُ", "ضِ", "ضَا", "ضُو", "ضِي", "ضًا", "ضٌ", "ضٍ", "اَلضَّـ", "اَلضُّـ", "اَلضِّـ", "ض"],
        'ط': ["طَ", "طُ", "طِ", "طَا", "طُو", "طِي", "طًا", "طٌ", "طٍ", "اَلطَّـ", "اَلطُّـ", "اَلطِّـ", "ط"],
        'ظ': ["ظَ", "ظُ", "ظِ", "ظَا", "ظُو", "ظِي", "ظًا", "ظٌ", "ظٍ", "اَلظَّـ", "اَلظُّـ", "اَلطِّـ", "ظ"],
        'ع': ["عَ", "عُ", "عِ", "عَا", "عُو", "عِي", "عًا", "عٌ", "عٍ", "اَلْـعَ", "اَلْـعُ", "اَلْـعِ", "ع"], 
        'غ': ["غَ", "غُ", "غِ", "غَا", "غُو", "غِي", "غًا", "غٌ", "غٍ", "اَلْـغَ", "اَلْـغُ", "اَلْـغِ", "غ"], 
        'ف': ["فَ", "فُ", "فِ", "فَا", "فُو", "فِي", "فًا", "فٌ", "فٍ", "اَلْـفَ", "اَلْـفُ", "اَلْْـفِ", "ف"], 
        'ق': ["قَ", "قُ", "قِ", "قَا", "قُو", "قِي", "قًا", "قٌ", "قٍ", "اَلْـقَ", "اَلْـقُ", "اَلْـقِ", "ق"], 
        'ك': ["كَ", "كُ", "كِ", "كَا", "كُو", "كِي", "كًا", "كٌ", "كٍ", "اَلْـكَ", "اَلْـكُ", "اَلْـكِ", "ك"], 
        'ل': ["لَ", "لُ", "لِ", "لَا", "لُو", "لِي", "لًا", "لٌ", "لٍ", "اَللَّـ", "اَللُّـ", "اَللِّـ", "ل"],
        'م': ["مَ", "مُ", "مِ", "مَا", "مُو", "مِي", "مًا", "مٌ", "مٍ", "اَلْـمَ", "اَلْـمُ", "اَلْـمِ", "م"], 
        'ن': ["نَ", "نُ", "نِ", "نَا", "نُو", "نِي", "نًا", "نٌ", "نٍ", "اَلنَّـ", "اَلنُّـ", "اَلنِّـ", "ن"],
        'ه': ["هَـ", "هُـ", "هِـ", "هَا", "هُو", "هِي", "هًا", "هٌ", "هٍ", "اَلْـهَـ", "اَلْـهُـ", "اَلْـهِـ", "ه"], 
        'و': ["وَ", "وُ", "وِ", "وَا", "وُو", "وِي", "وًا", "وٌ", "وٍ", "اَلْـوَ", "اَلْـوُ", "اَلْـوِ", "و"], 
        'ي': ["يَـ", "يُـ", "يِـ", "يَا", "يُو", "يِي", "يًا", "يٌ", "يٍ", "اَلْـيَـ", "اَلْْـيُـ", "اَلْْـيِـ", "ي"]
    };

    const WORDS_ARRAY = [
        "قَلَمٌ", "بَابٌ", "كِتَابٌ", "دَفْتَرٌ", "مَدْرَسَةٌ", 
        "سَمَاءٌ", "شَمْسٌ", "قَمَرٌ", "نَجْمَةٌ", "مَاءٌ",
        "أَمَلٌ", "وَقْتٌ", "صَوْتٌ", "حَرْفٌ", "طَرِيقٌ", 
        "بَيْتٌ", "جِدَارٌ", "مِصْبَاحٌ", "طَبِيبٌ", "مُعَلِّمٌ",
        "طِفْلٌ", "رَجُلٌ", "اِمْرَأَةٌ", "بِنْتٌ", "وَلَدٌ", 
        "لَيْلٌ", "نَهَارٌ", "صَبَاحٌ", "مَسَاءٌ", "غَدًا",
        "أَمْسِ", "يَوْمٌ", "أُسْبُوعٌ", "شَهْرٌ", "سَنَةٌ", 
        "عَيْنٌ", "أُذُنٌ", "أَنْفٌ", "فَمٌ", "يَدٌ",
        "رِجْلٌ", "رَأْسٌ", "شَعْرٌ", "لَوْنٌ", "أَبْيَضُ", 
        "أَسْوَدُ", "أَحْمَرُ", "أَخْضَرُ", "أَصْفَرُ", "أَزْرَقُ",
        "جَمِيلٌ", "كَبِيرٌ", "صَغِيرٌ", "طَوِيلٌ", "قَصِيرٌ", 
        "جَدِيدٌ", "قَدِيمٌ", "سَهْلٌ", "صَعْبٌ", "قَرِيبٌ",
        "بَعِيدٌ", "هَذَا", "هَذِهِ", "ذَلِكَ", "تِلْكَ", 
        "أَنَا", "أَنْتَ", "أَنْتِ", "هُوَ", "هِيَ",
        "نَحْنُ", "أَنْتُمْ", "هُمْ", "هَلْ", "مَتَى", 
        "أَيْنَ", "كَيْفَ", "مَاذَا", "مَنْ", "لِمَاذَا",
        "إِلَى", "عَلَى", "فِي", "مِنْ", "عَنْ", 
        "بِـ", "كَـ", "لِـ", "ثُمَّ", "وَ",
        "أَوْ", "لَا", "نَعَمْ", "قَدْ", "سَوْفَ", 
        "صَدِيقٌ", "جَارٌ", "أُسْرَةٌ", "أَبٌ", "أُمٌّ",
        "أَخٌ", "أُخْتٌ", "عَمٌّ", "خَالٌ", "جَدٌّ", 
        "فَوَاكِهُ", "تُفَّاحٌ", "مَوْزٌ", "عِنَبٌ", "بُرْتُقَالٌ",
        "خُضَارٌ", "طَمَاطِمُ", "خِيَارٌ", "جَزَرٌ", "بَطَاطِسُ", 
        "صِحَّةٌ", "طَاقَةٌ", "حَيَاةٌ", "مَوْتٌ", "نَوْمٌ",
        "اِسْتِيقَاظٌ", "جُلُوسٌ", "وُقُوفٌ", "مَشْيٌ", "جَرْيٌ", 
        "عَمَلٌ", "رَاحَةٌ", "سُكُونٌ", "حَرَكَةٌ", "هُدُوءٌ",
        "شَجَرَةٌ", "زَهْرَةٌ", "نَبَاتٌ", "أَرْضٌ", "جَبَلٌ", 
        "بَحْرٌ", "نَهْرٌ", "صَحْرَاءُ", "مَدِينَةٌ", "قَرْيَةٌ",
        "طَيْرٌ", "حَيَوَانٌ", "قِطَّةٌ", "كَلْبٌ", "حِصَانٌ", 
        "سَيَّارَةٌ", "دَرَّاجَةٌ", "قِطَارٌ", "طَائِرَةٌ", "سَفِينَةٌ",
        "طَعَامٌ", "شَرَابٌ", "حَلِيبٌ", "عَصِيرٌ", "خُبْزٌ", 
        "جُوعٌ", "عَطَشٌ", "شِبَعٌ", "اِرْتِوَاءٌ", "حُلْوٌ",
        "مُرٌّ", "مِلْحٌ", "سُكَّرٌ", "زَيْتٌ", "مَالٌ", 
        "غِنَى", "فَقْرٌ", "كَسَلٌ", "نَشَاطٌ", "سُرُورٌ",
        "حُزْنٌ", "غَضَبٌ", "رِضًا", "خَوْفٌ", "أَمْنٌ", 
        "قُوَّةٌ", "ضَعْفٌ", "سَرِيعٌ", "بَطِيءٌ", "جِدٌّ",
        "مُزَاحٌ", "عَذْبٌ", "مِلْحٌ", "نَظِيفٌ", "وَسِخٌ", 
        "حَارٌّ", "بَارِدٌ", "دَافِئٌ", "مُعْتَدِلٌ", "عَالٍ",
        "مُنْخَفِضٌ", "فَوْقَ", "تَحْتَ", "أَمَامَ", "خَلْفَ", 
        "يَمِينٌ", "يَسَارٌ", "وَسَطٌ", "جَانِبٌ", "بَيْنَ",
        "كُلٌّ", "بَعْضٌ", "غَيْرُ", "مِثْلُ", "لَكِنْ", 
        "أَيضًا", "أَوَّلُ", "آخِرُ", "مُبْكِرٌ", "مُتَأَخِّرٌ",
        "هَنَا", "هُنَاكَ", "جَمِيعٌ", "وَاحِدٌ", "اِثْنَانِ", 
        "ثَلَاثَةٌ", "أَرْبَعَةٌ", "خَمْسَةٌ", "سِتَّةٌ", "سَبْعَةٌ",
        "ثَمَانِيَةٌ", "تِسْعَةٌ", "عَشَرَةٌ", "مِائَةٌ", "أَلْفٌ", 
        "رَقْمٌ", "عَدَدٌ", "حِسَابٌ", "نَتِيجَةٌ", "جَوَابٌ",
        "سُؤَالٌ", "شَرْحٌ", "صَفْحَةٌ", "سَطْرٌ", "كَلِمَةٌ", 
        "جُمْلَةٌ", "قَاعَةٌ", "صَالَةٌ", "غُرْفَةٌ", "شُبَّاكٌ",
        "بَابٌ", "مِفْتَاحٌ", "قُفْلٌ", "نَافِذَةٌ", "سَتَائِرُ", 
        "طَاوِلَةٌ", "كُرْسِيٌّ", "خِزَانَةٌ", "فِرَاشٌ", "وِسَادَةٌ",
        "غَزَالٌ", "أَرْنَبٌ", "ثَعْلَبٌ", "ذِئْبٌ", "نَمِرٌ",
        "أَسَدٌ", "فِيلٌ", "زَرَافَةٌ", "جَمَلٌ", "حِمَارٌ",
        "قِرْدٌ", "ضِفْدَعٌ", "حَيَّةٌ", "سُلَحْفَاةٌ", "نَحْلَةٌ",
        "نَمْلَةٌ", "ذُبَابٌ", "بَعُوضَةٌ", "عَنْكَبُوتٌ", "فَرَاشَةٌ",
        "مَطَرٌ", "ثَلْجٌ", "بَرَدٌ", "رِيحٌ", "سَحَابٌ",
        "صَيْفٌ", "شِتَاءٌ", "خَرِيفٌ", "رَبِيعٌ", "فَصْلٌ",
        "حَقْلٌ", "بُسْتَانٌ", "مَزْرَعَةٌ", "أَشْجَارٌ", "أَزْهَارٌ",
        "فَاكِهَةٌ", "خُضْرَةٌ", "حَبَّةٌ", "ثَمَرَةٌ", "وَرَقَةٌ",
        "جِذْرٌ", "غُصْنٌ", "سَاقٌ", "زَيْتُونٌ", "تَمْرٌ",
        "قُطْنٌ", "قَمْحٌ", "شَعِيرٌ", "أُرْزٌ", "عَدَسٌ",
        "فُولٌ", "حِمَّصٌ", "سَمَكٌ", "لَحْمٌ", "دَجَاجٌ",
        "بَيْضٌ", "زُبْدَةٌ", "جُبْنٌ", "عَسَلٌ", "تَمْرٌ",
        "سُوقٌ", "مَتْجَرٌ", "بَائِعٌ", "مُشْتَرٍ", "ثَمَنٌ",
        "نُقُودٌ", "هَدِيَّةٌ", "خَصْمٌ", "تَخْفِيضٌ", "رِبْحٌ",
        "خَسَارَةٌ", "حِسَابٌ", "دَيْنٌ", "قَرْضٌ", "صَدَقَةٌ",
        "عِبَادَةٌ", "صَلَاةٌ", "صِيَامٌ", "زَكَاةٌ", "حَجٌّ",
        "دِينٌ", "إِسْلَامٌ", "إِيمَانٌ", "تَوْحِيدٌ", "نَبِيٌّ",
        "رَسُولٌ", "مَلَكٌ", "جِنٌّ", "إِنْسٌ", "كَوْنٌ",
        "جَنَّةٌ", "نَارٌ", "حَشْرٌ", "قِيَامَةٌ", "قَدَرٌ",
        "قَضَاءٌ", "حُكْمٌ", "عَدْلٌ", "ظُلْمٌ", "رَحْمَةٌ",
        "عَذَابٌ", "جَزَاءٌ", "صَوَابٌ", "خَطَأٌ", "صَبْرٌ",
        "شُكْرٌ", "حَمْدٌ", "ذِكْرٌ", "دُعَاءٌ", "اِسْتِغْفَارٌ",
        "تَوْبَةٌ", "خُشُوعٌ", "تَوَاضُعٌ", "كِبْرٌ", "غُرُورٌ",
        "حَقٌّ", "بَاطِلٌ", "صِدْقٌ", "كَذِبٌ", "أَمَانَةٌ",
        "خِيَانَةٌ", "وَعْدٌ", "عَهْدٌ", "صُلْحٌ", "خِصَامٌ",
        "خُطْوَةٌ", "جِهَةٌ", "مَكَانٌ", "زَمَانٌ", "مَوْقِعٌ",
        "طَبْعٌ", "فِكْرٌ", "عَقْلٌ", "قَلْبٌ", "رُوحٌ",
        "نَفْسٌ", "جَسَدٌ", "صُورَةٌ", "شَكْلٌ", "هَيْئَةٌ",
        "حَدِيثٌ", "قَوْلٌ", "كَلَامٌ", "صَمْتٌ", "سُكُوتٌ",
        "صُرَاخٌ", "هَمْسٌ", "غِنَاءٌ", "شِعْرٌ", "نَثْرٌ",
        "قِصَّةٌ", "رِوَايَةٌ", "مَسْرَحِيَّةٌ", "فِلْمٌ", "لُعْبَةٌ",
        "رِيَاضَةٌ", "كُرَةٌ", "سِبَاحَةٌ", "جَرْيٌ", "مُسَابَقَةٌ",
        "فَوْزٌ", "خَسَارَةٌ", "تَعَبٌ", "جُهْدٌ", "نَتِيجَةٌ",
        "أَمْرٌ", "نَهْيٌ", "طَلَبٌ", "إِذْنٌ", "رَفْضٌ",
        "قَبُولٌ", "شَرْطٌ", "عَقْدٌ", "اِتِّفَاقٌ", "خِلَافٌ",
        "بِنَاءٌ", "هَدْمٌ", "إِصْلَاحٌ", "تَخْرِيبٌ", "تَرْتِيبٌ",
        "فَوْضَى", "نِظَامٌ", "فَنٌّ", "رَسْمٌ", "نَحْتٌ",
        "مُوسِيقَى", "غِنَاءٌ", "تَمْثِيلٌ", "إِخْرَاجٌ", "إِعْلَامٌ",
        "جَرِيدَةٌ", "مَجَلَّةٌ", "كِتَابٌ", "مَكْتَبَةٌ", "قِرَاءَةٌ",
        "كِتَابَةٌ", "تَعْلِيمٌ", "تَدْرِيسٌ", "تَعَلُّمٌ", "طَالِبٌ",
        "مُعَلِّمٌ", "أُسْتَاذٌ", "دَرْسٌ", "اِمْتِحَانٌ", "نَجَاحٌ",
        "رُسُوبٌ", "شَهَادَةٌ", "جَامِعَةٌ", "كُلِّيَّةٌ", "مَعْهَدٌ",
        "شَرْقٌ", "غَرْبٌ", "شَمَالٌ", "جَنُوبٌ", "وِجْهَةٌ",
        "طَرِيقٌ", "رِحْلَةٌ", "سَفَرٌ", "عَوْدَةٌ", "اِسْتِقْبَالٌ",
        "تَوْدِيعٌ", "هُجْرَةٌ", "غُرْبَةٌ", "وَطَنٌ", "بَلَدٌ",
        "دَوْلَةٌ", "حُكُومَةٌ", "شَعْبٌ", "جَيْشٌ", "شُرْطَةٌ",
        "حَرْبٌ", "سِلْمٌ", "أَمْنٌ", "عَدْلٌ", "ظُلْمٌ",
        "سُجْنٌ", "حُرِّيَّةٌ", "عُبُودِيَّةٌ", "قَانُونٌ", "عُرْفٌ",
        "تَارِيخٌ", "مَاضٍ", "حَاضِرٌ", "مُسْتَقْبَلٌ", "ذِكْرَى",
        "نِسْيَانٌ", "عِلْمٌ", "جَهْلٌ", "حِكْمَةٌ", "حَمَاقَةٌ",
        "وِدٌّ", "كُرْهٌ", "حُبٌّ", "بُغْضٌ", "مَرَضٌ",
        "شِفَاءٌ", "صِحَّةٌ", "أَلَمٌ", "دَوَاءٌ", "عِلَاجٌ",
        "جِسْمٌ", "عُضْوٌ", "رِئَةٌ", "كَبِدٌ", "مَعِدَةٌ",
        "قَلْبٌ", "دَمٌ", "عَصَبٌ", "جِلْدٌ", "عَظْمٌ",
        "طَبِيعَةٌ", "جَوٌّ", "هَوَاءٌ", "نُورٌ", "ظَلَامٌ",
        "بَرْقٌ", "رَعْدٌ", "سُيُولٌ", "زِلْزَالٌ", "بُرْكَانٌ",
        "فَضَاءٌ", "كَوْكَبٌ", "قَمَرٌ", "شَمْسٌ", "مَجَرَّةٌ",
        "نِظَامٌ", "فَوْضَى", "أَثَرٌ", "صَدَى", "خُطُوطٌ",
        "شَبَكَةٌ", "هَاتِفٌ", "حَاسُوبٌ", "بَرْنَامَجٌ", "إِنْتَرْنِتٌ",
        "تَطْوِيرٌ", "مُسْتَوَى", "شَاشَةٌ", "هَدَفٌ", "تَحَدٍّ"
    ];

    const SENTENCES_ARRAY = [
        "ٱلشَّمْسُ أَشْرَقَتْ.", "ٱلْقَمَرُ ظَهَرَ.", "ٱلْجَوُّ بَارِدٌ.", "ٱلطِّفْلُ نَائِمٌ.", "ٱلزَّهْرُ تَفَتَّحَ.",
        "ٱلْكِتَابُ جَدِيدٌ.", "ٱلْبَابُ مَفْتُوحٌ.", "ٱلْوَلَدُ يَلْعَبُ.", "ٱلْبِنْتُ تَقْرَأُ.", "ٱلطَّيْرُ يُغَرِّدُ.",
        "ٱلْمَطَرُ نَزَلَ.", "ٱلنَّهْرُ جَارٍ.", "ٱلسَّمَكُ سَبَحَ.", "ٱلْكَلْبُ يَنْبَحُ.", "ٱلْقِطَّةُ تَمْشِي.",
        "أَنَا طَالِبٌ.", "أَنْتَ مُعَلِّمٌ.", "هُوَ سَرِيعٌ.", "هِيَ ذَكِيَّةٌ.", "نَحْنُ سُعَدَاءُ.",
        "ٱلْأَبُ عَائِدٌ.", "ٱلْأُمُّ تُطْبَخُ.", "ٱلْأَخُ يَنَامُ.", "ٱلْأُخْتُ تَكْتُبُ.", "ٱلْجَدُّ يَقْرَأُ.",
        "ٱلْمَاءُ صَافٍ.", "ٱلْحَقْلُ خَضِرٌ.", "ٱلْقَلَمُ مَكْسُورٌ.", "ٱلْكُرْسِيُّ ثَابِتٌ.", "ٱلْغُرْفَةُ مُنِيرَةٌ.",
        "أَكَلَ خَالِدٌ.", "شَرِبَتْ سَارَةُ.", "رَكِبَ أَحْمَدُ.", "نَظَرَتْ هِنْدٌ.", "جَلَسَ عَلِيٌّ.",
        "صَلَّى ٱلرَّجُلُ.", "سَافَرَ ٱلْعَائِلَةُ.", "بَنَى ٱلْعَامِلُ.", "زَارَ ٱلصَّدِيقُ.", "دَرَسَ ٱلطِّفْلُ.",
        "ٱلْحَرُّ شَدِيدٌ.", "ٱلْبَرْدُ قَارِسٌ.", "ٱللَّيْلُ مُظْلِمٌ.", "ٱلنَّهَارُ مُضِيءٌ.", "ٱلْهَوَاءُ نَقِيٌّ.",
        "هَذَا وَاجِبٌ.", "تِلْكَ قِصَّةٌ.", "مَاذَا تُرِيدُ؟", "أَيْنَ ٱلْكُتُبُ؟", "كَيْفَ ٱلْحَالُ؟",
        "ٱلْوَرْدُ أَزْهَرَ.", "ٱلْخُبْزُ سَاخِنٌ.", "ٱلْقِرْدُ يَتَسَلَّقُ.", "ٱلصَّوْتُ جَمِيلٌ.", "ٱلنُّورُ سَاطِعٌ.", 
        "هَذَا ٱلْجَوُّ جَمِيلٌ.", "تَنَاوَلَ ٱلطِّفْلُ طَعَامَهُ.", "كَتَبَ ٱلطَّالِبُ دَرْسَهُ.", "ذَهَبَ ٱلْوَلَدُ إِلَى ٱلْبَيْتِ.", "قَرَأَتْ سَارَةُ ٱلْقِصَّةَ.",
        "ٱلْعَامِلُ يَعْمَلُ بِجِدٍّ.", "ٱلْفَلَّاحُ يَزْرَعُ ٱلْأَرْضَ.", "ٱلطَّائِرُ يُحَلِّقُ عَالِيًا.", "ٱلسَّفِينَةُ تَبْحَرُ بِسُرْعَةٍ.", "أَنَا أُحِبُّ ٱلْقِرَاءَةَ.",
        "أَنْتَ صَدِيقِي ٱلْمُخْلِصُ.", "هِيَ طَبِيبَةٌ مَاهِرَةٌ.", "نَحْنُ نَلْعَبُ بِٱلْكُرَةِ.", "هُمْ يَأْكُلُونَ ٱلطَّعَامَ.", "أَنْتُمْ تُشَاهِدُونَ ٱلتِّلْفَازَ.",
        "ٱلْأُمُّ تُحِبُّ أَطْفَالَهَا.", "ٱلْأَبُ يَعْمَلُ كَثِيرًا.", "ٱلْأَخُ يُسَاعِدُ أُخْتَهُ.", "ٱلْجَدَّةُ تَحْكِي قِصَصًا.", "ٱلْعُصْفُورُ يَطِيرُ بِسُرُورٍ.",
        "ٱلْحِصَانُ يَرْكُضُ فِي ٱلْحَقْلِ.", "ٱلْقِطَّةُ تَشْرَبُ ٱلْحَلِيبَ.", "ٱلطَّبِيبُ يُعَالِجُ ٱلْمَرْضَى.", "ٱلْغُرْفَةُ نَظِيفَةٌ وَمُرَتَّبَةٌ.", "ٱلْمِفْتَاحُ عَلَى ٱلطَّاوِلَةِ.",
        "ٱلْقَمَرُ يُنِيرُ ٱللَّيْلَ.", "ٱلنَّجْمَةُ تَلْمَعُ فِي ٱلسَّمَاءِ.", "ٱلْأَطْفَالُ يَضْحَكُونَ بِفَرَحٍ.", "ٱلْمُعَلِّمُ يَشْرَحُ ٱلدَّرْسَ.", "ٱلْحِجَارَةُ صَلْبَةٌ جِدًّا.",
        "ٱلرَّسَّامُ يَرْسُمُ لَوْحَةً.", "ٱلسَّمَكُ يَعِيشُ فِي ٱلْمَاءِ.", "ٱلْحَقِيبَةُ مَلِيئَةٌ بِٱلْكُتُبِ.", "ٱلْجَوُّ مُعْتَدِلٌ ٱليَوْمَ.", "ٱلْوَلَدُ يُحِبُّ ٱلْفَوَاكِهَ.",
        "زَارَتْ هِنْدٌ صَدِيقَتَهَا.", "شَرِبَ مُحَمَّدٌ عَصِيرًا.", "أَخَذَ عَلِيٌّ قَلَمًا.", "لَبِسَتْ فَاطِمَةُ ثَوْبًا.", "رَفَعَ ٱلطِّفْلُ يَدَهُ.",
        "ٱلْغُرْفَةُ وَاسِعَةٌ جِدًّا.", "ٱلْمَطَرُ غَزِيرٌ جِدًّا.", "ٱلْعَمَلُ عِبَادَةٌ كَبِيرَةٌ.", "ٱلصَّوْتُ مُرْتَفِعٌ جِدًّا.", "ٱلْخُبْزُ طَازَجٌ وَلَذِيذٌ.",
        "جَلَسَ ٱلشَّيْخُ فِي ٱلْمَسْجِدِ.", "ٱلسُّوقُ مُزْدَحِمٌ بِٱلنَّاسِ.", "ٱلطَّالِبُ نَاجِحٌ بِتَفَوُّقٍ.", "ٱلْوَقْتُ ثَمِينٌ جِدًّا.", "ٱلْحَيَاةُ مَلِيئَةٌ بِٱلْأَمَلِ.",
        "قَرَأَ ٱلْمُعَلِّمُ ٱلْكِتَابَ.", "شَاهَدَ ٱلْجَمِيعُ ٱلْفِيلْمَ.", "تَكَلَّمَ ٱلرَّجُلُ بِهُدُوءٍ.", "لَعِبَتْ مَرْيَمُ بِٱلْعُقَدِ.", "أَكَلْنَا طَعَامًا لَذِيذًا.",
        "نَسْمَعُ ٱلصَّوْتَ عَالِيًا.", "رَأَيْتُ ٱلنَّمْلَةَ تَجْمَعُ.", "بَدَأَ ٱلْعَمَلُ صَبَاحًا.", "اِنْتَهَى ٱلدَّرْسُ مُسَاءً.", "ٱلشَّجَرَةُ تُثْمِرُ تِينًا.",
        "ٱلْحَدِيقَةُ مَلِيئَةٌ بِٱلْزُّهُورِ.", "ٱلْمَدِينَةُ تَنَامُ لَيْلًا.", "ٱلْأَرْضُ تَدُورُ حَوْلَ ٱلشَّمْسِ.", "ٱلسَّيَّارَةُ سَرِيعَةٌ جِدًّا.", "هَذَا ٱلْكَلْبُ وَفِيٌّ.",
        "قَامَ ٱلْوَلَدُ بِنَشَاطٍ.", "سَأَلَ ٱلطَّالِبُ سُؤَالًا.", "أَجَابَ ٱلْمُعَلِّمُ بِصَبْرٍ.", "بَدَأَتْ ٱلْحِصَّةُ مُبَكِّرًا.", "اِنْتَهَى ٱلْيَوْمُ سَرِيعًا.",
        "ٱلْكُرَةُ فِي ٱلْمَلْعَبِ.", "ٱلْفُرْشَاةُ فِي ٱلْحَمَّامِ.", "ٱلْمَاءِ جَارٍ كَٱلنَّهْرِ.", "ٱلْحَيَوَانُ يَبْحَثُ عَنْ طَعَامٍ.", "ٱلْمُسَافِرُ يَنْتَظِرُ ٱلْقِطَارَ.",
        "ٱلطِّبَاعَةُ مِهْنَةٌ رَائِعَةٌ.", "ٱلْجَمَلُ يَمْشِي فِي ٱلصَّحْرَاءِ.", "ٱلْخُيُولُ تَرْكُضُ بِقُوَّةٍ.", "ٱلْفَأْرُ هَرَبَ مِنْ ٱلْقِطَّةِ.", "ٱلْقَمِيصُ لَوْنُهُ أَخْضَرُ.",
        "ٱلطَّقْسُ مُمْطِرٌ خَارِجًا.", "ٱلْقِرَاءَةُ مُفِيدَةٌ لِلْعَقْلِ.", "ٱلصَّيْدُ مُمْتِعٌ فِي ٱلْغَابَةِ.", "ٱلْحُلْمُ جَمِيلٌ بِٱللَّيْلِ.", "ٱلْوَفَاءُ صِفَةٌ نَادِرَةٌ.",
        "أَنَا أَشْرَبُ ٱلْعَصِيرَ.", "هَلْ أَنْتَ مُوَافِقٌ؟", "مَتَى سَنَلْتَقِي؟", "أَيْنَ ذَهَبَ أَخُوكَ؟", "كَيْفَ سَافَرْتَ إِلَى مِصْرَ؟",
        "هَذِهِ فِكْرَةٌ جَيِّدَةٌ.", "تِلْكَ بِنَايَةٌ عَالِيَةٌ.", "ٱلْمَطْبَخُ دَافِئٌ جِدًّا.", "ٱلشَّاطِئُ مَلِيءٌ بِٱلْأَرْمَالِ.", "ٱلْكُوبُ مَمْلُوءٌ بِٱلْْمَاءِ.",
        "ٱلْغَضَبُ ضَارٌّ بِٱلصِّحَّةِ.", "ٱلرِّضَا كَنْزٌ لَا يَفْنَى.", "ٱلْخَوْفُ يُضْعِفُ ٱلْإِنْسَانَ.", "ٱلْأَمْنُ نِعْمَةٌ عَظِيمَةٌ.", "ٱلْفَقْرُ لَيْسَ عَيْبًا.",
        "جَبَلٌ عَالٍ جِدًّا.", "بَحْرٌ هَادِئٌ وَسَاحِرٌ.", "نَهْرٌ يَجْرِي بِخُفْيَةٍ.", "صَحْرَاءُ وَاسِعَةٌ جِدًّا.", "مَدِينَةٌ صَاخِبَةٌ بِٱلنَّاسِ.",
        "قَرْيَةٌ هَادِئَةٌ وَجَمِيلَةٌ.", "طَيْرٌ يُغَرِّدُ بِصَوْتٍ عَذْبٍ.", "قِطَّةٌ تَلْعَبُ بِٱلْخَيْطِ.", "كَلْبٌ يَحْرُسُ ٱلْمَنْزِلَ.", "حِصَانٌ يَجُرُّ ٱلْعَرَبَةَ.",
        "سَيَّارَةٌ تَنْتَظِرُ عِنْدَ ٱلْإِشَارَةِ.", "دَرَّاجَةٌ تَقُودُ بِسُرْعَةٍ.", "قِطَارٌ يَتَّجِهُ إِلَى ٱلْجَنُوبِ.", "طَائِرَةٌ تَحْلِقُ فِي ٱلسَّمَاءِ.", "سَفِينَةٌ رَاسِيَةٌ فِي ٱلْمِينَاءِ.",
        "تَنَاوَلَ ٱلْجَمِيعُ ٱلْغَدَاءَ.", "أَكَلْنَا ٱلتُّفَّاحَ وَٱلْمَوْزَ.", "شَرِبْنَا ٱلْحَلِيبَ ٱلطَّازَجَ.", "ٱلْعَصِيرُ مُنْعِشٌ جِدًّا.", "ٱلْخُبْزُ أُكِلَ سَرِيعًا.",
        "ٱلْحُلْوُ لَذِيذٌ وَشَهِيٌّ.", "ٱلسُّكَّرُ أُضِيفَ إِلَى ٱلشَّايِ.", "ٱلْمِلْحُ زَادَ طَعْمَ ٱلطَّبَقِ.", "ٱلزَّيْتُ يُسْتَخْدَمُ فِي ٱلطَّبْخِ.", "ٱلْمَالُ وُسِيلَةٌ لِلْحَيَاةِ.",
        "ٱلْغِنَى لَيْسَ سَعَادَةً.", "ٱلْكَسَلُ يُؤَدِّي إِلَى ٱلْفَشَلِ.", "ٱلنَّشَاطُ يُجَلِّبُ ٱلنَّجَاحَ.", "ٱلسُّرُورُ يَغْمُرُ ٱلْقَلْبَ.", "ٱلْحُزْنُ يُذِيبُ ٱلرُّوحَ.",
        "ٱلْغَضَبُ يُفْسِدُ ٱلْعَلَاقَاتِ.", "ٱلرِّضَا يَجْلُبُ ٱلطُّمَأْنِينَةَ.", "ٱلْقُوَّةُ تَأْتِي مِنَ ٱلْعَقْلِ.", "ٱلضَّعْفُ لَيْسَ عَجْزًا.", "ٱلْجِدُّ يَفْتَحُ ٱلْأَبْوَابَ.",
        "ٱلْمُزَاحُ يُبَدِّدُ ٱلْمَلَلَ.", "ٱلْمَاءُ عَذْبٌ وَنَقِيٌّ.", "ٱلْمَلَابِسُ نَظِيفَةٌ وَجَمِيلَةٌ.", "ٱلْجَوُّ حَارٌّ جِدًّا.", "ٱلْهَوَاءُ بَارِدٌ وَمُنْعِشٌ.",
        "ٱلطَّقْسُ دَافِئٌ وَجَمِيلٌ.", "ٱلْحَقِيقَةُ فَوْقَ كُلِّ شَيْءٍ.", "ٱلْأَطْفَالُ تَحْتَ ٱلشَّجَرَةِ.", "ٱلْوَلَدُ أَمَامَ ٱلْمَنْزِلِ.", "ٱلْكِتَابُ خَلْفَ ٱلْحَائِلِ.",
        "ٱلطِّفْلُ يَمْشِي عَلَى ٱلْيَمِينِ.", "ٱلْبِنْتُ تَقِفُ عَلَى ٱلْيَسَارِ.", "ٱلسَّاعَةُ فِي ٱلْوَسَطِ.", "ٱلْجَارُ يَجْلِسُ جَانِبَنَا.", "ٱلشَّهْرُ بَيْنَ شَهْرَيْنِ.",
        "كُلُّ ٱلنَّاسِ مُتَسَاوُونَ.", "بَعْضُ ٱلطُّلَّابِ غَائِبُونَ.", "هَذَا ٱلْعَمَلُ غَيْرُ مُنَاسِبٍ.", "هِيَ مِثْلُ أُمِّهَا.", "لَكِنَّ ٱلْوَقْتَ قَدْ فَاتَ.",
        "سَأَذْهَبُ أَيْضًا مَعَهُمْ.", "أَوَّلُ ٱلْعَمَلِ صَبْرٌ.", "آخِرُ ٱلْأَمْرِ سَعَادَةٌ.", "جَاءَ ٱلْقِطَارُ مُبَكِّرًا.", "ذَهَبَ ٱلطَّالِبُ مُتَأَخِّرًا.",
        "تَحْتَ ٱلْجَبَلِ وَادِي.", "ٱلْهَدَفُ سَامٍ وَنَبِيلٌ.", "نَحْنُ نَحْتَاجُ ٱلْمَطَرَ.", "ٱلْقَاعَةُ مُضَاءَةٌ جَيِّدًا.", "ٱلرَّجُلُ ذُو خُلُقٍ حَسَنٍ.",
        "هَذَا ٱلْقَلَمُ لَوْنُهُ أَحْمَرُ.", "ٱلطَّائِرُ ٱلصَّغِيرُ طَارَ عَالِيًا.", "ذَهَبَ خَالِدٌ إِلَى ٱلْمَدْرَسَةِ مُسْرِعًا.", "ٱلْكِتَابُ ٱلْجَدِيدُ عَلَى ٱلطَّاوِلَةِ.", "تَقْرَأُ ٱلْبِنْتُ ٱلْكِتَابَ كُلَّ يَوْمٍ.",
        "رَأَيْتُ ٱلْقَمَرَ فِي ٱلسَّمَاءِ لَيْلًا.", "تَنَامُ ٱلْقِطَّةُ ٱلصَّغِيرَةُ بِهُدُوءٍ.", "ٱلْحِصَانُ ٱلْكَبِيرُ يَأْكُلُ ٱلْعُشْبَ.", "ٱلْأَطْفَالُ يَلْعَبُونَ فِي ٱلْحَدِيقَةِ مَعًا.", "ٱلْأُمُّ ٱلْحَنُونَةُ تُعِدُّ ٱلْفُطُورَ لَنَا.",
        "نَحْنُ نَشْرَبُ ٱلْمَاءَ كُلَّ يَوْمٍ.", "يُسَاعِدُ ٱلْأَخُ أُخْتَهُ فِي ٱلدَّرْسِ.", "ٱلْمُعَلِّمُ يَشْرَحُ ٱلْقَوَاعِدَ بِسُهُولَةٍ.", "ٱلسَّيَّارَةُ ٱلْجَدِيدَةُ لَوْنُهَا أَزْرَقُ.", "ٱلطَّقْسُ غَدًا سَيَكُونُ مُعْتَدِلًا.",
        "جَلَسْنَا تَحْتَ شَجَرَةِ ٱلتِّينِ ٱلْعَالِيَةِ.", "صَوْتُ ٱلْعُصْفُورِ ٱلصَّغِيرِ جَمِيلٌ جِدًّا.", "تَأْكُلُ ٱلْأُسْرَةُ ٱلْفَوَاكِهَ فِي ٱلْمَسَاءِ.", "ٱلْمَطَرُ يَنْزِلُ عَلَى ٱلْأَرْضِ بِهُدُوءٍ.", "كَتَبَ ٱلطِّفْلُ ٱلْوَاجِبَ بِخَطٍّ جَمِيلٍ.",
        "يَزُورُ ٱلْأَبُ ٱلْجَدَّ كُلَّ أُسْبُوعٍ.", "شَرِبَ مُحَمَّدٌ ٱلْعَصِيرَ مِنْ كُوبٍ زُجَاجِيٍّ.", "ٱلْهَوَاءُ ٱلنَّقِيُّ مُفِيدٌ لِلصِّحَّةِ.", "ٱلْمَدِينَةُ مَلِيئَةٌ بِٱلْأَضْوَاءِ ٱلسَّاطِعَةِ.", "نَظَرْتُ إِلَى ٱلنُّجُومِ فِي ٱلسَّمَاءِ ٱلْمُظْلِمَةِ.",
        "ٱلْكُتُبُ تُرَتَّبُ دَاخِلَ ٱلْخِزَانَةِ بِعِنَايَةٍ.", "أَنَا أَذْهَبُ إِلَى ٱلْعَمَلِ مُبَكِّرًا دَائِمًا.", "لَا تَلْعَبْ بِٱلْكُرَةِ دَاخِلَ ٱلْبَيْتِ أَبَدًا.", "هَذَا ٱلْفِيلْمُ ٱلْجَدِيدُ مُشَوِّقٌ جِدًّا.", "ٱلْوَلَدُ ٱلْمُهَذَّبُ يُحِبُّ مُسَاعَدَةَ ٱلْآخَرِينَ.",
        "رَكِبْنَا ٱلْقِطَارَ ٱلسَّرِيعَ إِلَى ٱلشَّمَالِ.", "قَامَتْ سَارَةُ بِرِحْلَةٍ سَعِيدَةٍ مَعَ أَبِيهَا.", "ٱلشَّمْسُ تُشْرِقُ عَلَى ٱلْجِبَالِ ٱلْعَالِيَةِ.", "ٱلْغُرْفَةُ مُضَاءَةٌ بِفَضْلِ ٱلْمِصْبَاحِ.", "ٱلْجَارُ ٱلطَّيِّبُ يُسَاعِدُ جَارَهُ ٱلْفَقِيرَ.",
        "نَظَّفَ ٱلْعَامِلُ ٱلْأَرْضَ مِنْ ٱلْأَوْسَاخِ.", "ٱلْبِنْتُ ٱلصَّغِيرَةُ تَرْسُمُ زَهْرَةً جَمِيلَةً.", "قَرَأَ ٱلْجَدُّ قِصَّةً عَنِ ٱلْحَيَوَانَاتِ ٱلْبَرِّيَّةِ.", "سَافَرْنَا بِٱلطَّائِرَةِ إِلَى دَوْلَةٍ بَعِيدَةٍ.", "ٱلْفَشَلُ لَيْسَ نِهَايَةَ ٱلطَّرِيقِ بَلْ بِدَايَتَهُ.",
        "ٱلطَّالِبُ يَجْتَهِدُ لِلْحُصُولِ عَلَى دَرَجَاتٍ عَالِيَةٍ.", "أَخِي ٱلْكَبِيرُ يَعْمَلُ فِي شَرِكَةٍ كَبِيرَةٍ.", "شَرِبْنَا ٱلْحَلِيبَ ٱلدَّافِئَ قَبْلَ ٱلنَّوْمِ.", "ٱلْحَدِيقَةُ ٱلْخَضْرَاءُ مَكَانٌ رَائِعٌ لِلْعَبِ.", "نَرْكُضُ فِي ٱلْمَلْعَبِ كُلَّ مَسَاءٍ بِحَمَاسٍ.",
        "ٱلْمُهَنْدِسُ يَبْنِي ٱلْجُسُورَ عَلَى ٱلنَّهْرِ ٱلْكَبِيرِ.", "تَأْكُلُ ٱلطُّيُورُ ٱلْحُبُوبَ مِنْ ٱلْأَرْضِ ٱلْخِصْبَةِ.", "ٱلْقَلَمُ فِي ٱلْحَقِيبَةِ ٱلْزَّرْقَاءِ بِجَانِبِ ٱلدَّفْتَرِ.", "هَلْ سَتَزُورُنَا فِي ٱلْإِجَازَةِ ٱلْقَادِمَةِ؟", "ٱلْوَقْتُ يَمْضِي سَرِيعًا عِنْدَ ٱلْمُتْعَةِ.",
        "كَتَبَتْ مَرْيَمُ رِسَالَةً قَصِيرَةً إِلَى صَدِيقَتِهَا.", "ٱلْكَلْبُ يَجْرِي خَلْفَ ٱلْقِطَّةِ بِسُرْعَةٍ خَارِقَةٍ.", "ٱلْأُمُّ تَطْبَخُ طَعَامًا شَهِيًّا فِي ٱلْمَطْبَخِ.", "ٱلسُّكُوتُ أَفْضَلُ مِنْ كَلَامٍ لَا نَفْعَ فِيهِ.", "يَجِبُ أَنْ نُحَافِظَ عَلَى نَظَافَةِ ٱلْمَدِينَةِ.",
        "هَذِهِ ٱلطَّاوِلَةُ ٱلْخَشَبِيَّةُ جَدِيدَةٌ وَجَمِيلَةٌ.", "ٱلْحَقُّ يَعْلُو وَلَا يُعْلَى عَلَيْهِ أَبَدًا.", "ٱلْفَأْرُ يَهْرُبُ مِنْ ٱلْقِطَّةِ ٱلْمُفْتَرِسَةِ سَرِيعًا.", "ٱلْمَطَرُ يَغْسِلُ ٱلْأَشْجَارَ وَٱلْأَوْرَاقَ ٱلْخَضْرَاءَ.", "ٱلْوَلَدُ ٱلصَّغِيرُ يَقْطِفُ ٱلزَّهْرَةَ ٱلْحَمْرَاءَ.",
        "قَامَ ٱلْأُسْتَاذُ بِشَرْحِ ٱلدَّرْسِ ٱلصَّعْبِ بِتَمَعُّنٍ.", "ٱلْحَرُّ فِي ٱلصَّيْفِ شَدِيدٌ وَلَا يُحْتَمَلُ أَحْيَانًا.", "نَزُورُ ٱلْجَبَلَ ٱلْعَالِيَ فِي عُطْلَةِ ٱلْأُسْبُوعِ.", "ٱلْهَدِيَّةُ ٱلْبَسِيطَةُ تُعَبِّرُ عَنْ حُبٍّ كَبِيرٍ.", "ٱلْمَاءِ يُسَاعِدُ عَلَى نُمُوِّ ٱلزُّرُوعِ فِي ٱلْمَزَارِعِ.",
        "ٱلصَّبْرُ مِفْتَاحُ ٱلْفَرَجِ فِي كُلِّ شِدَّةٍ.", "كَلَّمْتُ صَدِيقِي عَلَى ٱلْهَاتِفِ ٱلْجَوَّالِ مُنْذُ قَلِيلٍ.", "ٱلطَّائِرَةُ تَحْمِلُ ٱلْمُسَافِرِينَ إِلَى بِلَادٍ بَعِيدَةٍ.", "ٱلطِّبَاعَةُ مُهِمَّةٌ لِنَشْرِ ٱلْعِلْمِ بَيْنَ ٱلنَّاسِ.", "ٱلْحَيَاةُ مَلِيئَةٌ بِٱلْمُغَامَرَاتِ وَٱلْأَسْرَارِ ٱلْعَجِيبَةِ.",
        "تَنَاوَلَ ٱلْجَمِيعُ ٱلْغَدَاءَ فِي مَطْعَمٍ جَدِيدٍ.", "ٱلشَّمْسُ تُنِيرُ ٱلْكَوْنَ بِضَوْئِهَا ٱلذَّهَبِيِّ ٱلسَّاطِعِ.", "لَا تَرْمِ ٱلْقُمَامَةَ عَلَى ٱلْأَرْضِ أَبَدًا.", "ٱلْأَخْطَاءُ تَجْعَلُنَا نَتَعَلَّمُ مِنْهَا كَثِيرًا.", "سَأَلَتْ نُورُ عَنْ وَقْتِ بَدْءِ ٱلِٱمْتِحَانِ ٱلنِّهَائِيِّ.",
        "ٱلْجَمَلُ سَفِينَةُ ٱلصَّحْرَاءِ لِصَبْرِهِ ٱلْكَبِيرِ.", "نَحْنُ نَحْتَفِلُ بِعِيدِ ٱلْفِطْرِ كُلَّ سَنَةٍ.", "ٱلْقِرَاءَةُ هِيَ مِفْتَاحُ ٱلْعُلُومِ ٱلْمُخْتَلِفَةِ.", "تَعَلَّمْنَا دَرْسًا جَدِيدًا فِي مَادَّةِ ٱلتَّارِيخِ ٱلْعَرَبِيِّ.", "ٱلْأَمْنُ وَٱلْأَمَانُ نِعْمَةٌ لَا تُقَدَّرُ بِثَمَنٍ."
    ];

    const PASSAGES_ARRAY = [
        "ٱلْأَمَانَةُ كَنْزٌ عَظِيمٌ. \n عَلَيْنَا أَنْ نُحَافِظَ عَلَى كُلِّ شَيْءٍ يُؤْتَمَنُ لَنَا، \n سَوَاءٌ كَانَ مَالًا أَوْ سِرًّا أَوْ وَعْدًا. ",
        "ٱلصَّدِيقُ ٱلْحَقِيقِيُّ يُشْبِهُ ٱلْمِصْبَاحَ. \n يَضِيءُ لَنَا ٱلطَّرِيقَ فِي ٱلظَّلَامِ، \n وَيُسَاعِدُنَا عِنْدَمَا نَقَعُ فِي ٱلشَّدَائِدِ.",
        "ٱلْمُعَلِّمُ هُوَ ٱلْأَبُ ٱلثَّانِي. \n يَمْنَحُنَا ٱلْعِلْمَ وَٱلْمَعْرِفَةَ بِصَبْرٍ، \n فَلْنُعْطِهِ حَقَّهُ مِنَ ٱلِٱحْتِرَامِ وَٱلتَّقْدِيرِ.",
        "كَوْكَبُ ٱلْأَرْضِ بَيْتُنَا ٱلْكَبِيرُ. \n يَجِبُ أَنْ نَحْمِيَ أَشْجَارَهُ وَمِيَاهَهُ، \n لِيَبْقَى جَمِيلًا وَنَقِيًّا لَنَا وَلِأَجْيَالِنَا.",
        "تَنَاوُلُ ٱلْفَوَاكِهِ يُعْطِينَا ٱلطَّاقَةَ. \n فَهِيَ مَلِيئَةٌ بِٱلْفِيتَامِينَاتِ ٱلْمُفِيدَةِ، \n لِذَلِكَ لَا تَنْسَ أَكْلَ ٱلتُّفَّاحِ كُلَّ صَبَاحٍ.",
        "ٱلْقِرَاءَةُ هِيَ مِفْتَاحُ ٱلْكُنُوزِ. \n كُلَّمَا قَرَأْتَ أَكْثَرَ، ٱزْدَادَ عَقْلُكَ نُورًا، \n وَتَعَرَّفْتَ عَلَى عَالَمٍ جَدِيدٍ وَشَاسِعٍ.",
        "ٱلْكَلِمَةُ ٱلطَّيِّبَةُ صَدَقَةٌ. \n هِيَ تُفْرِحُ قَلْبَ ٱلصَّدِيقِ ٱلْحَزِينِ، \n فَلَا تَتَرَدَّدْ أَبَدًا فِي قَوْلِ ٱلْحَسَنِ.",
        "ٱلصَّبْرُ مِفْتَاحُ ٱلْفَرَجِ. \n إِذَا وَاجَهْتَ صُعُوبَةً فَكُنْ هَادِئًا، \n فَكُلُّ شَيْءٍ صَعْبٍ يُمْكِنُ أَنْ يَصِيرَ سَهْلًا بِٱلْإِرَادَةِ.",
        "ٱلنَّظَافَةُ مِنْ ٱلْإِيمَانِ. \n إِذَا كَانَتْ مَلَابِسُنَا وَبَيْتُنَا نَظِيفَةً، \n نَشْعُرُ بِٱلرَّاحَةِ وَٱلسَّعَادَةِ دَائِمًا.",
        "ٱلْوَقْتُ ثَمِينٌ جِدًّا كَٱلذَّهَبِ. \n لَا نُضَيِّعْهُ فِي ٱللَّعِبِ بِلَا فَائِدَةٍ، \n بَلْ نَسْتَغِلَّهُ فِي ٱلدِّرَاسَةِ وَٱلْعَمَلِ ٱلصَّالِحِ.",
        "ٱلْعَائِلَةُ هِيَ ٱلسَّنَدُ ٱلْقَوِيُّ. \n نُسَاعِدُ أَبَانَا وَأُمَّنَا فِي أَعْمَالِهِمَا، \n وَنُحَافِظُ عَلَى مَحَبَّةِ ٱلْإِخْوَةِ وَٱلْأَخَوَاتِ.",
        "ٱلْحَيَوَانَاتُ أَيْضًا تَسْتَحِقُّ ٱلرِّفْقَ. \n لَا نُؤْذِ ٱلْقِطَّةَ أَوْ ٱلْكَلْبَ ٱلصَّغِيرَ، \n بَلْ نُقَدِّمُ لَهَا ٱلْمَاءَ وَٱلطَّعَامَ بِرَحْمَةٍ.",
        "ٱلشَّجَرَةُ مَصْدَرُ ٱلْحَيَاةِ. \n هِيَ تُعْطِينَا ٱلْهَوَاءَ ٱلنَّقِيَّ وَٱلظِّلَّ، \n لِذَا عَلَيْنَا أَنْ نَزْرَعَ وَلَا نَقْطَعَ ٱلْأَشْجَارَ.",
        "ٱلْإِصْرَارُ يُوصِلُنَا لِلْهَدَفِ. \n إِذَا تَعَثَّرْنَا فِي ٱلطَّرِيقِ لَا نَسْتَسْلِمُ، \n بَلْ نَقُومُ وَنُحَاوِلُ مَرَّةً أُخْرَى بِقُوَّةٍ.",
        "ٱلشُّكْرُ لِلَّهِ عَلَى ٱلنِّعَمِ. \n كُلُّ شَيْءٍ نَمْلِكُهُ هُوَ هَدِيَّةٌ مِنْهُ، \n فَلَا نَنْسَ أَبَدًا أَنْ نَحْمَدَهُ عَلَى كُلِّ حَالٍ.",
        "ٱلْكَرَمُ صِفَةُ ٱلْكِبَارِ. \n نَتَقَاسَمُ طَعَامَنَا وَأَلْعَابَنَا مَعَ ٱلْأَصْدِقَاءِ، \n فَمُسَاعَدَةُ ٱلْآخَرِينَ تَجْعَلُنَا سُعَدَاءَ.",
        "ٱلْمَطَرُ يَغْسِلُ ٱلْأَرْضَ. \n هُوَ يُرْوِي ٱلزُّرُوعَ وَٱلْأَشْجَارَ ٱلْعَطْشَانَةَ، \n فَلْنَفْرَحْ بِنُزُولِهِ وَنَشْكُرِ ٱلْخَالِقَ.",
        "ٱلنَّوْمُ ٱلْمُبَكِّرُ صِحَّةٌ لِلْجَسَدِ. \n عِنْدَمَا نَنَامُ مُبَكِّرًا، نَسْتَيْقِظُ نَشِيطِينَ، \n وَنُفَكِّرُ بِوُضُوحٍ وَإِيجَابِيَّةٍ كُلَّ يَوْمٍ.",
        "ٱلْحُبُّ لِلْوَطَنِ وَاجِبٌ. \n نَفْتَخِرُ بِتَارِيخِ بِلَادِنَا وَلُغَتِنَا، \n وَنَعْمَلُ بِجِدٍّ لِنُسَاهِمَ فِي تَقَدُّمِهِ.",
        "ٱلْعِلْمُ نُورٌ يُضِيءُ ٱلدُّرُوبَ. \n لَا نَتَوَقَّفْ عَنِ ٱلتَّعَلُّمِ وَٱلِٱسْتِفْسَارِ، \n لِنَصْبِحَ أَذْكِيَاءَ وَنَافِعِينَ لِأُمَّتِنَا."
    ];
    
    // **********************************************
    // ********** 2. الدوال المساعدة **********
    // **********************************************
    
    // دالة لخلط عناصر المصفوفة بشكل عشوائي (Fisher-Yates shuffle)
    function shuffleArray(array) {
        const newArray = [...array]; 
        for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
    }

    function buildCombinedSkills(char) {
        const baseSkills = BASE_SKILLS_FOR_RANDOM[char];
        if (!baseSkills) return '';
        // الكود الداخلي للدالة كما هو في النسخة السابقة (لم يتم تغيير محتواه لأنه يعمل بشكل صحيح)
        const BASE_CHAR_PURE = baseSkills[12];
        const BASE_CHAR_FATHA = baseSkills[0]; 
        const BASE_CHAR_DHAMMA = baseSkills[1];
        const BASE_CHAR_KASRA = baseSkills[2]; 

        const sukun_1 = SUKUN_PREFIXES[0] + BASE_CHAR_PURE + 'ْ';
        const sukun_2 = SUKUN_PREFIXES[1] + BASE_CHAR_PURE + 'ْ';
        let sukun_3 = SUKUN_PREFIXES[2] + BASE_CHAR_PURE + 'ْ';

        const shaddah_1 = SHADDAH_PREFIXES[0] + BASE_CHAR_PURE + 'َّ';
        let shaddah_2 = SHADDAH_PREFIXES[1] + BASE_CHAR_PURE + 'ُّ';
        let shaddah_3 = SHADDAH_PREFIXES[2] + BASE_CHAR_PURE + 'ِّ';

        if (char === 'أ') {
            sukun_3 = SUKUN_PREFIXES[2] + 'ئْـ';
            shaddah_2 = SHADDAH_PREFIXES[1] + 'ؤُّ';
            shaddah_3 = SHADDAH_PREFIXES[2] + 'ئِّـ';
        } else {
            sukun_3 = SUKUN_PREFIXES[2] + BASE_CHAR_PURE + 'ْـ';
        }

        const al_harf_1 = baseSkills[9]; 
        const al_harf_2 = baseSkills[10];
        const al_harf_3 = baseSkills[11];
        
        let extra_1, extra_2, extra_3, extra_4, extra_5;

        const sunLetters = ['ت', 'ث', 'د', 'ذ', 'ر', 'ز', 'س', 'ش', 'ص', 'ض', 'ط', 'ظ', 'ل', 'ن'];
        const isSunLetter = sunLetters.includes(char);

        const shaddah_FATHA = BASE_CHAR_PURE + 'َّـ';
        const shaddah_DHAMMA = BASE_CHAR_PURE + 'ُّـ';
        const shaddah_KASRA = BASE_CHAR_PURE + 'ِّـ';

        if (isSunLetter) {
            const AL_PREFIX_SUN_B = 'بِالْـ'.replace('لْ', 'ل');
            const AL_PREFIX_SUN_W = 'وَالْـ'.replace('لْ', 'ل');
            const AL_PREFIX_SUN_K = 'كَالْـ'.replace('لْ', 'ل');
            const AL_PREFIX_SUN_L = 'لِلْـ'.replace('لْ', 'ل');
            const AL_PREFIX_SUN_F = 'فَالْـ'.replace('لْ', 'ل');

            extra_1 = AL_PREFIX_SUN_B + shaddah_FATHA; 
            extra_2 = AL_PREFIX_SUN_W + shaddah_DHAMMA; 
            extra_3 = AL_PREFIX_SUN_K + shaddah_KASRA; 

            if (char === 'ل') {
                extra_4 = 'لِلَّـ' + BASE_CHAR_KASRA[BASE_CHAR_KASRA.length - 1]; 
            } else {
                extra_4 = AL_PREFIX_SUN_L + shaddah_KASRA; 
            }
            
            extra_5 = AL_PREFIX_SUN_F + shaddah_DHAMMA; 

        } else {
            extra_1 = 'بِالْـ' + BASE_CHAR_FATHA; 
            extra_2 = 'وَالْـ' + BASE_CHAR_DHAMMA; 
            extra_3 = 'كَالْـ' + BASE_CHAR_KASRA; 
            
            extra_4 = 'لِلْـ' + BASE_CHAR_KASRA; 
            extra_5 = 'فَالْـ' + BASE_CHAR_DHAMMA; 

            if (char === 'أ') {
                extra_1 = 'بِالْـأَ'; 
                extra_2 = 'وَالْـأُ'; 
                extra_3 = 'كَالْـإِ'; 
                extra_4 = 'لِلْـإِ'; 
                extra_5 = 'فَالْـأُ'; 
            }
        }
        
        const combined = [
            baseSkills[0], baseSkills[1], baseSkills[2], 
            baseSkills[3], baseSkills[4], baseSkills[5], 
            baseSkills[6], baseSkills[7], baseSkills[8], 
            sukun_1, sukun_2, sukun_3, 
            shaddah_1, shaddah_2, shaddah_3, 
            al_harf_1, al_harf_2, al_harf_3, 
            extra_1, extra_2, extra_3, 
            extra_4, extra_5, '', 
        ];

        return combined.join(' ');
    }
    
    function getAllIndividualSkills() {
        let allSkills = [];
        const baseChars = Object.keys(BASE_SKILLS_FOR_RANDOM);

        baseChars.forEach(char => {
            const combinedString = buildCombinedSkills(char);
            const individualSkills = combinedString.split(' ').filter(skill => skill.trim() !== '');
            allSkills = allSkills.concat(individualSkills);
        });
        return allSkills;
    }

    function convertToArabicNumbers(num) {
        const arabicNumbers = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
        return String(num).split('').map(digit => arabicNumbers[digit]).join('');
    }
    
    const ARABIC_LETTERS_NAMES = [
        'الألف', 'الباء', 'التاء', 'الثاء', 'الجيم', 
        'الحاء', 'الخاء', 'الدال', 'الذال', 'الراء', 
        'الزاي', 'السين', 'الشين', 'الصاد', 'الضاد', 
        'الطاء', 'الظاء', 'العين', 'الغين', 'الفاء', 
        'القاف', 'الكاف', 'اللام', 'الميم', 'النون', 
        'الهاء', 'الواو', 'الياء'
    ];

    /**
     * دالة لتجميع العناصر بالنسب الجديدة: 40% مهارات، 30% كلمات، 30% جمل
     * التعديل: التجميع الآن يتم بترتيب ثابت (مهارات، ثم كلمات، ثم جمل)
     */
    function getMixedChallengeItems(totalCount) {
        if (totalCount <= 0) return [];

        const allSkills = getAllIndividualSkills();
        const allWords = WORDS_ARRAY;
        const allSentences = SENTENCES_ARRAY;
        
        // 1. حساب الأعداد المطلوبة بالنسب (40%, 30%, 30%)
        let skillsCount = Math.round(totalCount * 0.4);
        let wordsCount = Math.round(totalCount * 0.3);
        let sentencesCount = totalCount - skillsCount - wordsCount; // ضمان أن المجموع يساوي totalCount
        
        // التأكد من عدم تجاوز العدد الإجمالي للمصادر
        skillsCount = Math.min(skillsCount, allSkills.length);
        wordsCount = Math.min(wordsCount, allWords.length);
        sentencesCount = Math.min(sentencesCount, allSentences.length);

        // 2. اختيار العناصر العشوائية من كل مصدر
        const randomSkills = shuffleArray(allSkills).slice(0, skillsCount); 
        const randomWords = shuffleArray(allWords).slice(0, wordsCount); 
        const randomSentences = shuffleArray(allSentences).slice(0, sentencesCount);
        
        // 3. دمج العناصر بالترتيب التدرجي المطلوب: (مهارات ثم كلمات ثم جمل)
        let finalArray = [
            ...randomSkills,    // القسم الأول: 40% مهارات
            ...randomWords,     // القسم الثاني: 30% كلمات
            ...randomSentences  // القسم الثالث: 30% جمل
        ];

        return finalArray;
    }


    // **********************************************
    // ********** 3. متغيرات وعناصر التحكم **********
    // **********************************************

    let itemsArray = [];
    let currentItemIndex = 0;
    let intervalDuration = 10000; 
    let quizInterval;
    // تم تغيير القيمة الافتراضية هنا لتكون 'reading'
    let selectedLevel = 'reading'; 
    let isAutoAdvance = true; 
    
    const setupScreen = document.getElementById('setup-screen');
    const quizDisplayDiv = document.getElementById('quiz-display');
    const currentItemElement = document.getElementById('current-item');
    const timerBar = document.getElementById('timer-bar');
    const quizTitle = document.getElementById('quiz-title');
    const errorMessage = document.getElementById('error-message');
    const traineeNameInput = document.getElementById('trainee-name');
    const startIndexInput = document.getElementById('start-index');
    const maxIndexTip = document.getElementById('max-index-tip');
    const durationSelect = document.getElementById('duration-select'); 
    const levelSelect = document.getElementById('level-select'); 
    const itemNumberTop = document.getElementById('item-number-top'); 
    const wordBox = document.getElementById('item-display'); 
    const startIndexGroup = document.getElementById('start-index-group');
    const modeSelect = document.getElementById('mode-select'); 
    const nextManualButton = document.getElementById('next-manual-button'); 
    const advanceModeInfo = document.getElementById('advance-mode-info');
    const durationTip = document.getElementById('duration-tip');
    
    // عناصر جديدة لـ LIMIT و Assessment
    const limitCountInput = document.getElementById('limit-count'); 
    const limitTip = document.getElementById('limit-tip');
    const assessmentScreen = document.getElementById('assessment-screen');
    const resultSummary = document.getElementById('result-summary');
    const errorCountInput = document.getElementById('error-count');
    const assessmentNotesTextarea = document.getElementById('assessment-notes');


    quizDisplayDiv.style.display = 'none'; 
    assessmentScreen.style.display = 'none'; 
    
    // **********************************************
    // ********** 4. دوال التحكم والتشغيل وحفظ السجل **********
    // **********************************************
    
    // دوال LocalStorage
    function getAssessmentHistory() {
        const history = localStorage.getItem('readingChallengeAssessments');
        return history ? JSON.parse(history) : [];
    }

    window.displayAssessmentHistory = function() {
        const history = getAssessmentHistory();
        if (history.length === 0) {
            alert("لا يوجد سجل تقييمات محفوظ بعد.");
            return;
        }

        let output = "--- سجل التقييمات المحفوظة ---\n";
        history.forEach((res, index) => {
            output += `\n#${convertToArabicNumbers(index + 1)} - المتدرب: ${res.traineeName}\n`;
            output += `المستوى: ${res.levelText}\n`;
            output += `تاريخ التقييم: ${new Date(res.timestamp).toLocaleDateString('ar-EG')}\n`;
            output += `العناصر: ${convertToArabicNumbers(res.totalItems)} | الأخطاء: ${convertToArabicNumbers(res.errors)}\n`;
            output += `ملاحظات: ${res.notes.substring(0, 50)}${res.notes.length > 50 ? '...' : ''}\n`;
        });
        
        console.log(output);
        alert(`تم عرض سجل ${convertToArabicNumbers(history.length)} تقييمات في وحدة التحكم (Console).`);
    }

    
    function startTimerBar(seconds) {
        if (!isAutoAdvance) {
            timerBar.style.width = '100%';
            timerBar.style.transition = 'none';
            return; 
        }

        timerBar.style.transition = 'none';
        timerBar.style.width = '100%';
        
        requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                timerBar.style.transition = `width ${seconds}s linear`;
                timerBar.style.width = '0%';
            });
        });
    }

    window.handleManualNext = function() {
        if (quizInterval) {
            clearInterval(quizInterval);
            quizInterval = null;
        }
        displayNextItem();
        
        if (isAutoAdvance) {
             quizInterval = setInterval(displayNextItem, intervalDuration);
        }
    }
    
    window.displayNextItem = function() {
        if (itemsArray.length === 0 || currentItemIndex >= itemsArray.length) {
            
            if (quizInterval) clearInterval(quizInterval);
            nextManualButton.style.display = 'none';
            itemNumberTop.style.display = 'none';
            timerBar.style.display = 'none';
            
            // الانتقال لشاشة التقييم
            quizDisplayDiv.style.display = 'none'; 
            assessmentScreen.style.display = 'block';
            
            const levelText = levelSelect.options[levelSelect.selectedIndex].text;
            const traineeName = traineeNameInput.value.trim();
            const totalItems = itemsArray.length;
            
            resultSummary.innerHTML = `المتدرب: **${traineeName}** <br> التحدي: **${levelText}** <br> عدد العناصر التي تم قراءتها: **${convertToArabicNumbers(totalItems)}**`;
            
            return;
        }
        
        const itemNumber = currentItemIndex + 1;
        const arabicItemNumber = convertToArabicNumbers(itemNumber); 
        const itemContent = itemsArray[currentItemIndex];
        
        let color = '#1f3f6c';

        // عرض خاص لمستوى الحروف المدمجة فقط
        if (selectedLevel === 'reading') {
            const individualChars = itemContent.split(' ');
            const currentLetterIndex = currentItemIndex;
            const letterName = ARABIC_LETTERS_NAMES[currentLetterIndex];

            const SKILL_NAMES = [
                'الحركات الأساسية', 
                'المد', 
                'التنوين', 
                'السكون', 
                'الشدة', 
                'الـ شمسية/قمرية', 
                'دخول حرف الجر على الـ', 
                ''
            ];

            itemNumberTop.style.display = 'block';
            itemNumberTop.innerHTML = `**رقم ${arabicItemNumber} / حرف ${letterName}**`;

            currentItemElement.classList.add('combined-skills');
            currentItemElement.classList.remove('default-display');

            color = '#1f3f6c'; 
            wordBox.style.borderColor = color;

            let htmlContent = '';
            
            htmlContent += `<div class="grid-cell skill-label" style="grid-row: 7 / span 2;">${SKILL_NAMES[6]}</div>`;

            for (let row = 0; row < 6; row++) {
                htmlContent += `<div class="grid-cell skill-label" style="grid-row: ${row + 1};">${SKILL_NAMES[row]}</div>`;
                for (let col = 0; col < 3; col++) {
                    const index = (row * 3) + col;
                    const char = individualChars[index] || '';
                    const displayChar = char.trim() === '' ? '&nbsp;' : char;
                    htmlContent += `<div class="grid-cell" style="grid-row: ${row + 1}; grid-column: ${col + 2}; border-color: #a0c0e0;">${displayChar}</div>`;
                }
            }
            
            for (let row = 6; row < 8; row++) {
                for (let col = 0; col < 3; col++) {
                    const index = 18 + ((row - 6) * 3) + col;
                    const char = individualChars[index] || '';
                    const displayChar = char.trim() === '' ? '&nbsp;' : char;
                    htmlContent += `<div class="grid-cell" style="grid-row: ${row + 1}; grid-column: ${col + 2}; border-color: #a0c0e0;">${displayChar}</div>`;
                }
            }

            currentItemElement.innerHTML = htmlContent;
        } 
        else {
             itemNumberTop.style.display = 'none';
            currentItemElement.classList.remove('combined-skills');
            currentItemElement.classList.add('default-display');
            
            let fontSize = '70px';

            // تحديد اللون وحجم الخط لجميع المستويات الأخرى، بما في ذلك المزيج الجديد
            if (selectedLevel === 'words') {
                color = '#e8a31a';
            } else if (selectedLevel === 'random_skill') {
                color = '#8e24aa';
                fontSize = '40px'; 
            } else if (selectedLevel === 'sentences' || selectedLevel === 'mixed_challenge') { 
                // نستخدم لون خاص للمزيج وللجمل
                 color = '#5cb85c'; 
                 fontSize = '40px'; 
                 if(itemContent.length > 50) fontSize = '30px';
            } else if (selectedLevel === 'passages') { 
                 color = '#00bcd4';
                 fontSize = '35px'; 
            }

            wordBox.style.borderColor = color;
            
            let htmlContent = `
                <div class="item-segment item-content" style="font-size: ${fontSize};">${itemContent}</div>
                <div class="item-segment item-number" style="font-size: ${fontSize}; border-left: 3px solid ${color};">${arabicItemNumber}</div>
            `;
             currentItemElement.innerHTML = htmlContent;
        }
        
        timerBar.style.backgroundColor = color; 
        
        startTimerBar(intervalDuration / 1000); 
        
        currentItemIndex = (currentItemIndex + 1);
        
        // التحقق من نهاية العناصر (التي ستؤدي للانتقال إلى شاشة التقييم)
        if (currentItemIndex >= itemsArray.length) {
            if (quizInterval) clearInterval(quizInterval);
            setTimeout(() => { 
                quizDisplayDiv.style.display = 'none'; 
                assessmentScreen.style.display = 'block';
                
                const levelText = levelSelect.options[levelSelect.selectedIndex].text;
                const traineeName = traineeNameInput.value.trim();
                const totalItems = itemsArray.length;
                
                resultSummary.innerHTML = `المتدرب: **${traineeName}** <br> التحدي: **${levelText}** <br> عدد العناصر التي تم قراءتها: **${convertToArabicNumbers(totalItems)}**`;
                
                itemNumberTop.style.display = 'none';
                nextManualButton.style.display = 'none';
            }, isAutoAdvance ? intervalDuration : 0); 
        }
    };

    window.startQuiz = function() {
        const startQuizBtn = document.getElementById('start-button');
        startQuizBtn.disabled = true;
        startQuizBtn.textContent = "جاري العرض...";

        setupScreen.style.display = 'none';
        quizDisplayDiv.style.display = 'block';
        
        intervalDuration = parseInt(durationSelect.value);
        selectedLevel = levelSelect.value;
        isAutoAdvance = (modeSelect.value === 'auto');
        
        const startNum = parseInt(startIndexInput.value) || 1; 
        const limitCount = parseInt(limitCountInput.value) || 0;

        // 1. تحديد مصفوفة البيانات وتطبيق **الخلط (Shuffle)** قبل التقطيع (Slice)
        if (selectedLevel === 'mixed_challenge') {
             // استخدام الدالة الجديدة التي تطبق النسب والخلط مسبقاً (مع الترتيب التدرجي)
             if (limitCount === 0) {
                 // يجب أن يكون هناك حد ليعمل المزيج
                 alert("الرجاء تحديد 'عدد العناصر المطلوب قراءتها' (Limit Count) لتشغيل التقييم.");
                 location.reload(); 
                 return;
             }
             itemsArray = getMixedChallengeItems(limitCount);
             startIndexInput.value = 1; // إجبار البدء من 1 لأن المصفوفة مختلطة وجديدة
        } else if (selectedLevel === 'words') {
            itemsArray = shuffleArray(WORDS_ARRAY); 
        } else if (selectedLevel === 'sentences') {
            itemsArray = shuffleArray(SENTENCES_ARRAY); 
        } else if (selectedLevel === 'passages') { 
            itemsArray = shuffleArray(PASSAGES_ARRAY); 
        } else if (selectedLevel === 'random_skill') {
            let allSkills = getAllIndividualSkills();
            itemsArray = shuffleArray(allSkills); 
        } else { // 'reading' (الحروف المدمجة) - لا يتم خلطها 
            const tempCombinedArray = [];
            const baseChars = Object.keys(BASE_SKILLS_FOR_RANDOM);

            baseChars.forEach(char => {
                tempCombinedArray.push(buildCombinedSkills(char));
            });
            itemsArray = tempCombinedArray;
        } 

        if (itemsArray.length === 0) {
            alert("لا توجد بيانات متاحة لهذا المستوى أو لم يتم تهيئتها بعد.");
            startQuizBtn.disabled = false;
            startQuizBtn.textContent = "ابدأ التقييم مجدداً";
            return;
        }
        
        // 2. تطبيق حد التحدي وتحديد نقطة البدء فقط للمستويات غير المدمجة (Mixed Challenge)
        if (selectedLevel !== 'mixed_challenge') {
            if (limitCount > 0) {
                const slicedStart = Math.max(0, startNum - 1);
                itemsArray = itemsArray.slice(slicedStart, slicedStart + limitCount);
            } else {
                 // إذا لم يتم تحديد حد، نبدأ من نقطة البدء إلى النهاية
                 itemsArray = itemsArray.slice(Math.max(0, startNum - 1));
            }
        }
        
        currentItemIndex = 0; // إعادة تعيين الفهرس بعد التقطيع/التصفية

        // 3. تحديد العنوان
        const levelText = levelSelect.options[levelSelect.selectedIndex].text;
        let levelMainTitle = 'تحدي القراءة: ';
        quizTitle.innerHTML = `${levelMainTitle} **${traineeNameInput.value.trim()}** - ${levelText}`; 
        
        // 4. تحديث عرض الوقت ورسالة الوضع
        let seconds = intervalDuration / 1000;
        let isMinute = seconds >= 60 && seconds % 60 === 0;
        let timeValue = isMinute ? seconds / 60 : seconds;
        let timeUnit = isMinute ? 'دقيقة' : 'ثوانٍ';
        
        if (isAutoAdvance) {
            advanceModeInfo.innerHTML = `ستتغير النصوص **تلقائيًا** كل <span id="time-display">${timeValue}</span> ${timeUnit}.`;
            nextManualButton.style.display = 'none';
            timerBar.style.display = 'block';
        } else {
            advanceModeInfo.innerHTML = `طريقة العرض **يدوية** (اضغط على الزر للتالي). المدة المحددة (${timeValue} ${timeUnit}) تُستخدم لشريط التقدم فقط.`;
            nextManualButton.style.display = 'block';
            timerBar.style.display = 'none';
        }

        // 5. بدء المؤقت والعرض
        if (quizInterval) {
            clearInterval(quizInterval);
        }
        
        displayNextItem(); 
        
        if (isAutoAdvance) {
            quizInterval = setInterval(displayNextItem, intervalDuration);
        }
    }

    const TOTAL_INDIVIDUAL_SKILLS = getAllIndividualSkills().length;

    const MAX_LIMITS = {
        'reading': Object.keys(BASE_SKILLS_FOR_RANDOM).length,
        'words': WORDS_ARRAY.length,
        'sentences': SENTENCES_ARRAY.length,
        'random_skill': TOTAL_INDIVIDUAL_SKILLS,
        'passages': PASSAGES_ARRAY.length,
        // تم تحديث الحد الأقصى للمزيج المخصص
        'mixed_challenge': Math.min(TOTAL_INDIVIDUAL_SKILLS, WORDS_ARRAY.length, SENTENCES_ARRAY.length) * 3 
    };

    window.validateAndStartQuiz = function() {
        errorMessage.style.display = 'none';
        
        if (traineeNameInput.value.trim() === "") {
            errorMessage.textContent = "الرجاء كتابة اسم المتدرب قبل البدء.";
            errorMessage.style.display = 'block';
            return;
        }

        const level = levelSelect.value;
        const startNum = parseInt(startIndexInput.value);
        const limitCount = parseInt(limitCountInput.value) || 0;
        
        if (level === 'mixed_challenge') {
            if (limitCount < 1 || limitCount > 500) { // حد معقول للتقييم
                 errorMessage.textContent = "لتشغيل التقييم، يجب أن يكون عدد العناصر المطلوب قراءتها بين 1 و 500.";
                 errorMessage.style.display = 'block';
                 return;
            }
            // في التقييم، نتجاهل Start Index، لكن نتحقق من الحد الأدنى للـ Limit
            startQuiz();
            return;
        }


        const MAX_LIMITS_INNER = MAX_LIMITS; // استخدام الكائن المحدث
        const maxAllowed = MAX_LIMITS_INNER[level];

        let currentArraySize = maxAllowed;
        
        if (isNaN(startNum) || startNum < 1 || startNum > maxAllowed) {
            let hint = (level === 'random_skill') ? `${convertToArabicNumbers(maxAllowed)} مهارة` : `${convertToArabicNumbers(maxAllowed)}`;
            if (level === 'passages') hint = `${convertToArabicNumbers(maxAllowed)} قطعة`;
            errorMessage.textContent = `رقم البدء غير صحيح. يجب أن يكون بين ١ و ${hint} ضمن هذا القسم.`;
            errorMessage.style.display = 'block';
            return;
        }

        
        if (limitCount > 0 && limitCount < 1) {
            errorMessage.textContent = "عدد العناصر المطلوب قراءتها يجب أن يكون 1 أو أكثر.";
            errorMessage.style.display = 'block';
            return;
        }
        
        if (limitCount > 0 && limitCount > currentArraySize) {
             errorMessage.textContent = `حد التحدي (${convertToArabicNumbers(limitCount)}) يتجاوز عدد العناصر المُعرَّفة فعلياً (${convertToArabicNumbers(currentArraySize)}).`;
             errorMessage.style.display = 'block';
             return;
        }
        
        if (limitCount > 0 && (startNum + limitCount - 1) > currentArraySize) {
             errorMessage.textContent = `نطاق العرض المطلوب (البدء من ${convertToArabicNumbers(startNum)} وقراءة ${convertToArabicNumbers(limitCount)}) يتجاوز العدد الكلي للعناصر المتاحة (${convertToArabicNumbers(currentArraySize)}).`;
             errorMessage.style.display = 'block';
             return;
        }

        startQuiz();
    }
    
    // دالة لحفظ التقييم (تم تحديثها لحفظ البيانات في LocalStorage)
    window.saveAssessment = function() {
        const traineeName = traineeNameInput.value.trim();
        const errors = parseInt(errorCountInput.value) || 0;
        const notes = assessmentNotesTextarea.value;
        const totalItems = itemsArray.length;
        const levelText = levelSelect.options[levelSelect.selectedIndex].text;
        
        // 1. إنشاء كائن النتيجة
        const resultObject = {
            traineeName,
            levelText,
            totalItems,
            errors,
            notes,
            timestamp: new Date().toISOString()
        };
        
        // 2. تحميل السجل القديم وإضافة النتيجة الجديدة
        let history = getAssessmentHistory();
        history.push(resultObject);

        // 3. حفظ السجل المحدث في LocalStorage
        try {
             localStorage.setItem('readingChallengeAssessments', JSON.stringify(history));
             console.log("تم حفظ التقييم: ", resultObject);
             alert(`تم حفظ التقييم للمتدرب ${traineeName} بنجاح! راجع سجل وحدة التحكم (Console) لمشاهدة التفاصيل.`);
        } catch (e) {
            alert("خطأ: تعذر حفظ التقييم في المتصفح.");
            console.error("LocalStorage save error:", e);
        }
        
        location.reload();
    }


    // **********************************************
    // ********** 5. تهيئة الواجهة والتحديث التلقائي **********
    // **********************************************
    document.addEventListener('DOMContentLoaded', () => {
        
        function updateSettingsUI() {
            const level = levelSelect.value;
            const actualMax = MAX_LIMITS[level];
            const arabicMax = convertToArabicNumbers(actualMax);
            let maxHint;

            if (level === 'mixed_challenge') {
                 // إخفاء رقم البدء واستخدام عدد العناصر فقط
                startIndexGroup.style.display = 'none';
                limitCountInput.min = 1;
                limitCountInput.value = 10;
                // تم تحديث تلميح المزيج ليتناسب مع الاسم الجديد "التقييم" والنسب
                limitTip.textContent = "يجب تحديد عدد العناصر المطلوب قراءتها لتطبيق نسب التقييم (40% مهارات، 30% كلمات، 30% جمل).";
                maxIndexTip.textContent = "(لا ينطبق لهذا التقييم)";
                document.getElementById('start-index').value = 1; // إعادة تعيين قيمة رقم البدء
            } else {
                 // عرض رقم البدء وتحديث الحدود
                startIndexGroup.style.display = 'flex';
                limitCountInput.min = 0;
                limitTip.textContent = "(أدخل 0 أو اتركها فارغة لعرض **كل** العناصر المتاحة).";
                
                if (level === 'words') {
                    maxHint = `${arabicMax} كلمة`;
                } else if (level === 'sentences') {
                    maxHint = `${arabicMax} جملة`;
                } else if (level === 'passages') { 
                     maxHint = `${arabicMax} قطعة`;
                } else if (level === 'random_skill') {
                     maxHint = `${arabicMax} مهارة فردية`;
                } else { 
                    maxHint = `${arabicMax} حرف`;
                }
                
                maxIndexTip.textContent = `(الحد الأقصى: ${arabicMax} - ${maxHint})`;
                startIndexInput.max = actualMax;
                
                if (parseInt(startIndexInput.value) > actualMax) {
                     startIndexInput.value = 1;
                }
            }
            
            selectedLevel = level;
            
            // تحديث نصوص الخيارات لتعكس الأرقام الإجمالية 
            const randomSkillOption = levelSelect.querySelector('option[value="random_skill"]');
            const arabicRandomMax = convertToArabicNumbers(MAX_LIMITS['random_skill']);
             if (randomSkillOption) {
                randomSkillOption.textContent = `تقييم مهاراة الحروف (${arabicRandomMax} مهارة)`; 
            }
            
            const readingOption = levelSelect.querySelector('option[value="reading"]');
            const arabicReadingMax = convertToArabicNumbers(MAX_LIMITS['reading']);
            if (readingOption) {
                readingOption.textContent = `الحروف المدمجة (${arabicReadingMax} حرف)`; 
            }
            
            const wordOption = levelSelect.querySelector('option[value="words"]');
            const arabicWordMax = convertToArabicNumbers(MAX_LIMITS['words']);
            if (wordOption) {
                wordOption.textContent = `الكلمات (${arabicWordMax} كلمة)`;
            }
            const sentenceOption = levelSelect.querySelector('option[value="sentences"]');
            const arabicSentenceMax = convertToArabicNumbers(MAX_LIMITS['sentences']);
            if (sentenceOption) {
                sentenceOption.textContent = `الجمل (${arabicSentenceMax} جملة)`;
            }
             const passageOption = levelSelect.querySelector('option[value="passages"]');
             const arabicPassageMax = convertToArabicNumbers(MAX_LIMITS['passages']);
             if (passageOption) {
                 passageOption.textContent = `القطع الهادفة (${arabicPassageMax} قطعة)`;
             }
             
             // تحديث نص خيار "التقييم" الجديد
             const mixedChallengeOption = levelSelect.querySelector('option[value="mixed_challenge"]');
             if (mixedChallengeOption) {
                 mixedChallengeOption.textContent = `التقييم (40% مهارات / 30% كلمات / 30% جمل)`;
             }
        }
        
        function updateDurationTip() {
            if (modeSelect.value === 'auto') {
                durationTip.textContent = "يحدد سرعة الانتقال التلقائي.";
                durationSelect.disabled = false;
            } else {
                durationTip.textContent = "المدة تُستخدم فقط لشريط التقدم المرئي (ولن يتم الانتقال تلقائيًا).";
                durationSelect.disabled = false;
            }
        }


        levelSelect.addEventListener('change', updateSettingsUI);
        
        durationSelect.addEventListener('change', function() {
            intervalDuration = parseInt(this.value);
        });
        
        modeSelect.addEventListener('change', updateDurationTip);

        updateSettingsUI(); 
        updateDurationTip(); 
    });

</script>
</body>
</html>
